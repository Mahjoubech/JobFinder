<div
  *ngIf="job"
  [class.bg-gradient-to-r]="isActive"
  [class.from-purple-50]="isActive"
  [class.to-purple-100]="isActive"
  [class.dark:from-slate-800]="isActive"
  [class.dark:to-slate-700]="isActive"
  [class.border-gray-100]="!isActive"
  [class.dark:border-l-purple-400]="isActive"
  [class.border-l-purple-400]="isActive"
  class="p-4 border-b border-gray-100 dark:border-slate-700 hover:bg-gradient-to-r hover:from-purple-50 hover:to-purple-100 dark:hover:from-slate-800 dark:hover:to-slate-700 cursor-pointer transition-all duration-300 relative group border-l-4 border-transparent hover:border-l-purple-500 dark:hover:border-l-purple-400 animate-fade-in-up"
>
  <div class="flex gap-4">
    <!-- Company Logo -->
    <div class="flex-shrink-0">
      <div
        class="w-12 h-12 rounded-lg shadow-sm border border-gray-100 dark:border-slate-600 flex items-center justify-center overflow-hidden transition-transform duration-300 group-hover:scale-105"
        [ngClass]="job.company.name | logoBackground"
      >
        <span class="text-lg font-bold">
          {{ job.company.name | companyInitials }}
        </span>
      </div>
    </div>

    <div class="flex-1 min-w-0">
      <h3
        [class.text-purple-600]="isActive"
        [class.dark:group:text-purple-400]="isActive"
        class="text-base font-bold text-gray-900 dark:text-white truncate group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors duration-300"
      >
        {{ job.name }}
      </h3>
      <p class="text-sm font-medium text-gray-700 dark:text-gray-300 truncate">
        {{ job.company.name }}
      </p>
      <div class="flex items-center gap-2 mt-1 text-xs text-gray-500 dark:text-gray-400">
        <span *ngIf="job.locations && job.locations.length > 0; else noLocation">{{
          job.locations[0].name
        }}</span>
        <ng-template #noLocation><span>Remote</span></ng-template>
      </div>

      <div class="flex items-center gap-3 mt-2">
        <div
          class="flex items-center gap-1 text-xs font-medium text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20 px-2 py-0.5 rounded-full border border-green-100 dark:border-green-800"
        >
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M13 10V3L4 14h7v7l9-11h-7z"
            ></path>
          </svg>
          <span *ngIf="job.levels && job.levels.length > 0; else noLevel">{{
            job.levels[0].name
          }}</span>
          <ng-template #noLevel><span>Entry Level</span></ng-template>
        </div>
        <!-- Date -->
        <span class="text-xs text-gray-400 dark:text-gray-500">{{ job.publication_date }}</span>
      </div>

      <!-- Favorite Button (Moved to Bottom Right) -->
      <button
        *ngIf="user"
        (click)="$event.stopPropagation(); toggleFavorite()"
        class="absolute bottom-4 right-4 p-2 rounded-full hover:bg-white/80 dark:hover:bg-slate-700/80 transition-all duration-300 group/fav z-10"
        type="button"
      >
        <svg
          class="w-5 h-5 transition-all duration-300"
          [class.fill-red-500]="isFavorite"
          [class.text-red-500]="isFavorite"
          [class.text-gray-400]="!isFavorite"
          [class.dark:text-gray-500]="!isFavorite"
          [class.group-hover/fav:text-red-500]="!isFavorite"
          [class.scale-110]="isFavorite"
          viewBox="0 0 24 24"
          stroke="currentColor"
          stroke-width="2"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
          />
        </svg>
      </button>
    </div>
  </div>
</div>
